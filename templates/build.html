{% extends "base.html" %}

{% block title %}MineBuild - Сборка сервера{% endblock %}

{% block extra_css %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/build.css') }}">
{% endblock %}

{% block body_class %}build-body{% endblock %}

{% block content %}
<div class="build-page">
    <div class="build-background"></div>
    <div class="build-content">
        <div class="container">
            <section class="build-header animate-fade-in">
                <h1>Сборка MineBuild</h1>
                <p class="build-description">
                    Ванильная сборка Minecraft с тщательно подобранными модификациями, улучшающими как визуальную составляющую, так и игровой процесс. Наша сборка создана для максимально комфортной игры на сервере MineBuild.
                </p>
                <a href="#download" class="scroll-button">
                    <span>К скачиванию</span>
                    <i class="fas fa-chevron-down"></i>
                </a>
            </section>
            
            <section class="gallery-section animate-slide-up">
                <div class="section-title-container">
                    <h2>Галерея</h2>
                    <div class="accent-line"></div>
                </div>
                <div class="gallery-container">
                    {% set build_images = [
                        '2024-08-19_14.14.19.webp',
                        '2024-08-29_13.35.54.webp',
                        '2024-09-14_22.57.40.webp',
                        '2024-09-14_23.03.49.webp',
                        '2024-10-26_23.09.56.webp',
                        '2024-10-27_16.21.52.webp',
                        '2024-11-03_17.54.01.webp',
                        '2024-11-04_16.36.15.webp',
                        '2024-11-09_13.57.33.webp',
                        '2024-11-09_13.57.39.webp',
                        '2024-11-19_17.54.29.webp',
                        '2024-11-20_22.02.24.webp',
                        '2024-12-15_15.13.58.webp',
                        '2024-12-28_22.27.40.webp',
                        '2025-01-07_00.29.14.webp',
                        '2025-03-01_13.38.55.webp',
                        '2025-04-20_13.33.16.webp',
                        '2025-04-20_13.33.22.webp',
                        '2025-04-20_13.33.27.webp',
                        '2025-04-20_17.32.54.webp',
                        '2025-04-20_17.32.58.webp',
                        '2025-04-20_17.33.03.webp',
                        '2025-04-20_17.33.08.webp',
                        'Снежный городок.webp'
                    ] %}
                    {% for image in build_images %}
                        <div class="gallery-item {% if loop.first %}current{% elif loop.index == 2 %}next{% elif loop.index == build_images|length %}prev{% else %}hidden{% endif %}">
                            <img src="{{ url_for('static', filename='images/build/' + image) }}" alt="MineBuild Screenshot">
                        </div>
                    {% endfor %}
                    <div class="gallery-nav">
                        {% for image in build_images %}
                            <div class="gallery-dot {% if loop.first %}active{% endif %}" data-index="{{ loop.index0 }}"></div>
                        {% endfor %}
                    </div>
                </div>
            </section>

            <section class="mods-section animate-slide-up">
                <div class="section-title-container">
                    <h2>Список модификаций</h2>
                    <div class="accent-line"></div>
                </div>

                <div class="mod-category">
                    <h3 class="category-title">Оптимизация и функции OptiFine</h3>
                    <div class="mods-list">
                        <div class="mod-card">
                            <h3 class="mod-name">Sodium и дополнения</h3>
                            <p class="mod-description">Замена OptiFine с улучшенной производительностью. Включает Sodium Extra для дополнительных настроек, Reeses Sodium Options для удобного интерфейса и Sodium Dynamic Lights для динамического освещения</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">CIT Resewn</h3>
                            <p class="mod-description">Возвращает функцию OptiFine для изменения текстуры предмета по переименованию в наковальне</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Continuity</h3>
                            <p class="mod-description">Добавляет соединение текстур между блоками. Например, стекло не будет иметь рамки внутри окна</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Entity Culling</h3>
                            <p class="mod-description">Использует асинхронную трассировку лучей для скрытия невидимых объектов, значительно улучшая производительность</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Lithium и ModernFix</h3>
                            <p class="mod-description">Оптимизация игровых механик и общей производительности без изменения ванильного геймплея</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">EMF & ETF</h3>
                            <p class="mod-description">Поддержка ресурс-паков с анимированными сущностями, например Fresh Animations</p>
                        </div>
                    </div>
                </div>

                <div class="mod-category">
                    <h3 class="category-title">Улучшения визуальной составляющей</h3>
                    <div class="mods-list">
                        <div class="mod-card">
                            <h3 class="mod-name">Advancement Plaques</h3>
                            <p class="mod-description">Улучшенный внешний вид достижений и их описаний</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Better Clouds</h3>
                            <p class="mod-description">Улучшенные облака с поддержкой различных шейдеров и настраиваемыми пресетами</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Falling Leaves</h3>
                            <p class="mod-description">Добавляет анимацию падающих листьев с деревьев</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Particle Rain</h3>
                            <p class="mod-description">Значительно улучшает погодные эффекты, сохраняя ванильную стилистику</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Particular</h3>
                            <p class="mod-description">Добавляет различные визуальные эффекты и частицы для многих игровых действий</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Not Enough Animations</h3>
                            <p class="mod-description">Улучшенные анимации персонажа</p>
                        </div>
                    </div>
                </div>

                <div class="mod-category">
                    <h3 class="category-title">Улучшения интерфейса</h3>
                    <div class="mods-list">
                        <div class="mod-card">
                            <h3 class="mod-name">Chat Patches</h3>
                            <p class="mod-description">Расширенный менеджер чата: время отправки сообщений, сохранение истории, дополнительные функции</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Chat Heads</h3>
                            <p class="mod-description">Показывает головы игроков перед их сообщениями в чате</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Mouse Tweaks</h3>
                            <p class="mod-description">Улучшенное управление инвентарем: новые механики перетаскивания и быстрого перемещения предметов</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Smooth Scrolling</h3>
                            <p class="mod-description">Плавная прокрутка во всех меню игры</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">BetterF3</h3>
                            <p class="mod-description">Улучшенный отладочный экран с настраиваемым интерфейсом на русском языке</p>
                        </div>
                    </div>
                </div>

                <div class="mod-category">
                    <h3 class="category-title">Улучшения звука</h3>
                    <div class="mods-list">
                        <div class="mod-card">
                            <h3 class="mod-name">Presence Footsteps</h3>
                            <p class="mod-description">Значительно улучшает звуки ходьбы по различным поверхностям</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Sound Physics Remastered</h3>
                            <p class="mod-description">Добавляет реалистичное эхо и объемное звучание</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Sounds</h3>
                            <p class="mod-description">Добавляет звуки для интерфейса и различных действий с настраиваемыми параметрами</p>
                        </div>
                    </div>
                </div>

                <div class="mod-category">
                    <h3 class="category-title">Полезные утилиты</h3>
                    <div class="mods-list">
                        <div class="mod-card">
                            <h3 class="mod-name">Litematica</h3>
                            <p class="mod-description">Позволяет создавать и просматривать схемы построек даже на серверах</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">WorldEdit</h3>
                            <p class="mod-description">Мощный инструмент для строительства и редактирования мира</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Xaero's World Map</h3>
                            <p class="mod-description">Детальная карта мира с множеством функций</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Bobby</h3>
                            <p class="mod-description">Сохраняет прогруженные чанки в кэш для большей дистанции прорисовки даже на серверах</p>
                        </div>
                        <div class="mod-card">
                            <h3 class="mod-name">Resourcify</h3>
                            <p class="mod-description">Позволяет скачивать и обновлять ресурс-паки, шейдеры и датапаки прямо в игре</p>
                        </div>
                    </div>
                </div>
            </section>

            <section class="requirements-section animate-slide-up">
                <div class="section-title-container">
                    <h2>Системные требования</h2>
                    <div class="accent-line"></div>
                </div>
                <div class="requirements-list">
                    <div class="requirement-card">
                        <i class="fas fa-microchip"></i>
                        <h3>Процессор</h3>
                        <p>Intel Core i3 / AMD Ryzen 3 или лучше</p>⁠
                    </div>
                    <div class="requirement-card">
                        <i class="fas fa-memory"></i>
                        <h3>Оперативная память</h3>
                        <p>Минимум 4 ГБ, рекомендуется 8 ГБ</p>
                    </div>
                    <div class="requirement-card">
                        <i class="fas fa-desktop"></i>
                        <h3>Видеокарта</h3>
                        <p>NVIDIA GeForce GTX 1060 / AMD Radeon RX 580 или лучше</p>
                    </div>
                </div>
            </section>

            <section id="download" class="download-section animate-slide-up">
                <div class="download-card">
                    <h2>Готовы начать игру?</h2>
                    <p>Скачайте нашу сборку и присоединяйтесь к серверу прямо сейчас!</p>
                    <a href="https://github.com/KOFIOK/EventsPack" target="_blank" class="download-button">
                        <i class="fas fa-download me-2"></i>Скачать сборку
                    </a>
                </div>
            </section>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
document.addEventListener('DOMContentLoaded', function() {
    const galleryItems = document.querySelectorAll('.gallery-item');
    const dots = document.querySelectorAll('.gallery-dot');
    let currentIndex = 0;
    let isAnimating = false;
    const totalItems = galleryItems.length;
    let slideInterval = null; // Добавляем переменную для хранения интервала
    
    function startSlideInterval() {
        // Очищаем предыдущий интервал перед созданием нового
        if (slideInterval) {
            clearInterval(slideInterval);
        }
        slideInterval = setInterval(() => {
            updateGallery((currentIndex + 1) % totalItems, 'right');
        }, 5000);
    }
    
    function updateGallery(newIndex, direction) {
        if (isAnimating) return;
        isAnimating = true;
        
        // Обновляем точки навигации
        dots.forEach(dot => dot.classList.remove('active'));
        dots[newIndex].classList.add('active');
        
        const oldIndex = currentIndex;
        currentIndex = newIndex;
        
        // Получаем индексы для prev и next элементов
        const prevIndex = (currentIndex - 1 + totalItems) % totalItems;
        const nextIndex = (currentIndex + 1) % totalItems;
        
        // Сначала убираем все классы
        galleryItems.forEach(item => {
            item.classList.remove('prev', 'current', 'next', 'hidden', 'moving-left', 'moving-right', 'visible');
            item.classList.add('hidden');
        });
        
        // Устанавливаем начальные позиции
        if (direction === 'right') {
            galleryItems[oldIndex].classList.remove('hidden');
            galleryItems[oldIndex].classList.add('moving-left');
            
            galleryItems[prevIndex].classList.remove('hidden');
            galleryItems[prevIndex].classList.add('prev');
            
            galleryItems[currentIndex].classList.remove('hidden');
            galleryItems[currentIndex].classList.add('current');
            
            // Следующее изображение появится с задержкой
            setTimeout(() => {
                galleryItems[nextIndex].classList.remove('hidden');
                galleryItems[nextIndex].classList.add('next');
                requestAnimationFrame(() => {
                    setTimeout(() => {
                        galleryItems[nextIndex].classList.add('visible');
                    }, 50);
                });
            }, 300);
            
        } else if (direction === 'left') {
            galleryItems[oldIndex].classList.remove('hidden');
            galleryItems[oldIndex].classList.add('moving-right');
            
            galleryItems[prevIndex].classList.remove('hidden');
            galleryItems[prevIndex].classList.add('prev');
            
            galleryItems[currentIndex].classList.remove('hidden');
            galleryItems[currentIndex].classList.add('current');
            
            // Следующее изображение появится с задержкой
            setTimeout(() => {
                galleryItems[nextIndex].classList.remove('hidden');
                galleryItems[nextIndex].classList.add('next');
                requestAnimationFrame(() => {
                    setTimeout(() => {
                        galleryItems[nextIndex].classList.add('visible');
                    }, 50);
                });
            }, 300);
        } else {
            // Первоначальная установка или прямой переход по точкам
            galleryItems[prevIndex].classList.remove('hidden');
            galleryItems[prevIndex].classList.add('prev');
            
            galleryItems[currentIndex].classList.remove('hidden');
            galleryItems[currentIndex].classList.add('current');
            
            galleryItems[nextIndex].classList.remove('hidden');
            galleryItems[nextIndex].classList.add('next', 'visible');
        }
        
        // Сбрасываем флаг анимации после завершения всех переходов
        setTimeout(() => {
            isAnimating = false;
            // Очищаем ненужные классы
            galleryItems.forEach(item => {
                if (item.classList.contains('moving-left') || item.classList.contains('moving-right')) {
                    item.classList.add('hidden');
                    item.classList.remove('moving-left', 'moving-right');
                }
            });
        }, 800);
    }
    
    // Обработка клика по точкам
    dots.forEach((dot, index) => {
        dot.addEventListener('click', () => {
            if (isAnimating) return;
            const direction = index > currentIndex ? 'right' : 'left';
            updateGallery(index, direction);
            // Перезапускаем интервал
            startSlideInterval();
        });
    });
    
    // Обработка наведения мыши
    const galleryContainer = document.querySelector('.gallery-container');
    galleryContainer.addEventListener('mouseenter', () => {
        if (slideInterval) {
            clearInterval(slideInterval);
            slideInterval = null;
        }
    });
    
    galleryContainer.addEventListener('mouseleave', () => {
        startSlideInterval();
    });
    
    // Инициализация галереи и запуск автоматического переключения
    updateGallery(0);
    startSlideInterval();
});
</script>
{% endblock %}