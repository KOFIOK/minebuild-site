"""
–û–±—â–∏–µ —É—Ç–∏–ª–∏—Ç—ã –¥–ª—è Discord –±–æ—Ç–∞ MineBuild
"""

import logging
import discord
from typing import List, Dict, Any, Optional

from ..config import QUESTION_MAPPING
from ..config_manager import get_moderator_role_id

logger = logging.getLogger("MineBuildBot.Utils")


def has_moderation_permissions(user: discord.Member) -> bool:
    """
    –ü—Ä–æ–≤–µ—Ä—è–µ—Ç –µ—Å—Ç—å –ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∞–≤–∞ –Ω–∞ –º–æ–¥–µ—Ä–∞—Ü–∏—é.
    
    Args:
        user: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å Discord
        
    Returns:
        bool: True –µ—Å–ª–∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –µ—Å—Ç—å –ø—Ä–∞–≤–∞, –∏–Ω–∞—á–µ False
    """
    return (
        user.guild_permissions.administrator or
        any(role.id == get_moderator_role_id() for role in user.roles)
    )


def extract_minecraft_nickname(embeds: List[discord.Embed]) -> Optional[str]:
    """
    –ò–∑–≤–ª–µ–∫–∞–µ—Ç –Ω–∏–∫–Ω–µ–π–º Minecraft –∏–∑ embed-—Å–æ–æ–±—â–µ–Ω–∏–π.
    
    Args:
        embeds: –°–ø–∏—Å–æ–∫ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π
        
    Returns:
        str –∏–ª–∏ None: –ù–∏–∫–Ω–µ–π–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Minecraft –∏–ª–∏ None –µ—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω
    """
    # –í–æ–∑–º–æ–∂–Ω—ã–µ –Ω–∞–∑–≤–∞–Ω–∏—è –ø–æ–ª–µ–π —Å –Ω–∏–∫–Ω–µ–π–º–æ–º
    nickname_field_names = [
        '–ò–≥—Ä–æ–≤–æ–π –Ω–∏–∫–Ω–µ–π–º –≤ Minecraft',      # –ù–æ–≤–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ —Å —Å–∞–π—Ç–∞
        '–í–∞—à –Ω–∏–∫–Ω–µ–π–º –≤ Minecraft',          # –°—Ç–∞—Ä–æ–µ –Ω–∞–∑–≤–∞–Ω–∏–µ
        '–í–∞—à –Ω–∏–∫–Ω–µ–π–º –≤ Minecraft:',         # –° –¥–≤–æ–µ—Ç–æ—á–∏–µ–º
        '–ù–∏–∫–Ω–µ–π–º –≤ Minecraft',              # –°–æ–∫—Ä–∞—â–µ–Ω–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
        'Minecraft –Ω–∏–∫–Ω–µ–π–º',                # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –≤–∞—Ä–∏–∞–Ω—Ç
        '–ù–∏–∫ –≤ Minecraft',                  # –ö—Ä–∞—Ç–∫–∞—è —Ñ–æ—Ä–º–∞
        '–ù–∏–∫–Ω–µ–π–º Minecraft',                # –ë–µ–∑ –ø—Ä–µ–¥–ª–æ–≥–∞
        'Minecraft Nickname',               # –ê–Ω–≥–ª–∏–π—Å–∫–∏–π –≤–∞—Ä–∏–∞–Ω—Ç
        'MC –Ω–∏–∫–Ω–µ–π–º',                       # –°–æ–∫—Ä–∞—â–µ–Ω–∏–µ MC
        '–ò–≥—Ä–æ–≤–æ–π –Ω–∏–∫',                      # –ë–µ–∑ —É–ø–æ–º–∏–Ω–∞–Ω–∏—è Minecraft
        '–í –∏–≥—Ä–µ –Ω–∏–∫',                       # –†–∞–∑–≥–æ–≤–æ—Ä–Ω–∞—è —Ñ–æ—Ä–º–∞
        '–ò–º—è –≤ –∏–≥—Ä–µ'                        # –û–ø–∏—Å–∞—Ç–µ–ª—å–Ω–∞—è —Ñ–æ—Ä–º–∞
    ]
    
    for embed in embeds:
        # –°–Ω–∞—á–∞–ª–∞ –∏—â–µ–º —Ç–æ—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
        for field in embed.fields:
            if field.name in nickname_field_names:
                nickname = field.value.strip()
                if nickname:  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –Ω–∏–∫–Ω–µ–π–º –Ω–µ –ø—É—Å—Ç–æ–π
                    logger.info(f"–ù–∞–π–¥–µ–Ω –Ω–∏–∫–Ω–µ–π–º Minecraft: '{nickname}' –≤ –ø–æ–ª–µ '{field.name}'")
                    return nickname
        
        # –ï—Å–ª–∏ —Ç–æ—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –Ω–µ—Ç, –ø—Ä–æ–±—É–µ–º —á–∞—Å—Ç–∏—á–Ω–æ–µ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ
        for field in embed.fields:
            field_name_lower = field.name.lower()
            if any(keyword in field_name_lower for keyword in ['minecraft', '–Ω–∏–∫–Ω–µ–π–º', '–Ω–∏–∫']):
                nickname = field.value.strip()
                if nickname:  # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —á—Ç–æ –Ω–∏–∫–Ω–µ–π–º –Ω–µ –ø—É—Å—Ç–æ–π
                    logger.info(f"–ù–∞–π–¥–µ–Ω –Ω–∏–∫–Ω–µ–π–º Minecraft –ø–æ —á–∞—Å—Ç–∏—á–Ω–æ–º—É —Å–æ–≤–ø–∞–¥–µ–Ω–∏—é: '{nickname}' –≤ –ø–æ–ª–µ '{field.name}'")
                    return nickname
    
    # –ï—Å–ª–∏ –Ω–µ –Ω–∞—à–ª–∏, –ª–æ–≥–∏—Ä—É–µ–º –≤—Å–µ –ø–æ–ª—è –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏
    logger.warning("‚ùå –ù–∏–∫–Ω–µ–π–º Minecraft –Ω–µ –Ω–∞–π–¥–µ–Ω –≤ –∑–∞—è–≤–∫–µ!")
    logger.warning("üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –ø–æ–ª—è –≤ embed:")
    for i, embed in enumerate(embeds):
        logger.warning(f"  Embed {i + 1}:")
        if not embed.fields:
            logger.warning("    (–Ω–µ—Ç –ø–æ–ª–µ–π)")
        else:
            for j, field in enumerate(embed.fields):
                logger.warning(f"    –ü–æ–ª–µ {j + 1}: '{field.name}' = '{field.value}'")
    
    logger.warning("üîç –ò—Å–∫–∞–ª–∏ –ø–æ–ª—è —Å –Ω–∞–∑–≤–∞–Ω–∏—è–º–∏:")
    for name in nickname_field_names:
        logger.warning(f"  - '{name}'")
    logger.warning("üîç –ê —Ç–∞–∫–∂–µ –ø–æ–ª—è, —Å–æ–¥–µ—Ä–∂–∞—â–∏–µ –∫–ª—é—á–µ–≤—ã–µ —Å–ª–æ–≤–∞: 'minecraft', '–Ω–∏–∫–Ω–µ–π–º', '–Ω–∏–∫'")
    
    return None


async def process_approval(
    interaction: discord.Interaction, 
    member: discord.Member, 
    minecraft_nickname: str
) -> None:
    """
    –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–æ—Ü–µ—Å—Å –æ–¥–æ–±—Ä–µ–Ω–∏—è –∑–∞—è–≤–∫–∏.
    
    Args:
        interaction: –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ Discord
        member: –û–±—ä–µ–∫—Ç —É—á–∞—Å—Ç–Ω–∏–∫–∞
        minecraft_nickname: –ù–∏–∫–Ω–µ–π–º —É—á–∞—Å—Ç–Ω–∏–∫–∞ –≤ Minecraft
    """
    from ..utils.minecraft import add_to_whitelist
    
    # –ü—Ä–æ–±—É–µ–º –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫–Ω–µ–π–º
    try:
        await member.edit(nick=minecraft_nickname)
    except discord.Forbidden:
        logger.warning(f"–ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫–Ω–µ–π–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {member.id}")
        await interaction.followup.send(
            "–ù–µ —É–¥–∞–ª–æ—Å—å –∏–∑–º–µ–Ω–∏—Ç—å –Ω–∏–∫–Ω–µ–π–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è. –ü–æ–∂–∞–ª—É–π—Å—Ç–∞, —Å–¥–µ–ª–∞–π—Ç–µ —ç—Ç–æ –≤—Ä—É—á–Ω—É—é.",
            ephemeral=True
        )
    
    # –î–æ–±–∞–≤–ª—è–µ–º –≤ –±–µ–ª—ã–π —Å–ø–∏—Å–æ–∫ —á–µ—Ä–µ–∑ RCON
    await add_to_whitelist(interaction, minecraft_nickname)


def create_embed_with_fields(title: str, fields_data: List[Dict[str, Any]], timestamp=None) -> discord.Embed:
    """
    –°–æ–∑–¥–∞–µ—Ç Embed —Å –ø–æ–ª—è–º–∏ –¥–∞–Ω–Ω—ã—Ö.
    
    Args:
        title: –ó–∞–≥–æ–ª–æ–≤–æ–∫ embed
        fields_data: –°–ø–∏—Å–æ–∫ —Å–ª–æ–≤–∞—Ä–µ–π —Å –¥–∞–Ω–Ω—ã–º–∏ –ø–æ–ª–µ–π
        timestamp: –í—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
        
    Returns:
        discord.Embed: –ì–æ—Ç–æ–≤—ã–π embed –æ–±—ä–µ–∫—Ç
    """
    embed = discord.Embed(
        title=title,
        color=0x00ff00,  # –ó–µ–ª–µ–Ω—ã–π —Ü–≤–µ—Ç
        timestamp=timestamp
    )
    
    for field_data in fields_data:
        field_name = QUESTION_MAPPING.get(field_data.get('id', ''), field_data.get('question', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π –≤–æ–ø—Ä–æ—Å'))
        field_value = field_data.get('answer', '–ù–µ—Ç –æ—Ç–≤–µ—Ç–∞')
        
        embed.add_field(
            name=field_name,
            value=field_value,
            inline=False
        )
    
    return embed


async def update_approval_message(message: discord.Message, discord_id: str) -> None:
    """
    –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏ –ø—Ä–∏ –æ–¥–æ–±—Ä–µ–Ω–∏–∏.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ Discord —Å –∑–∞—è–≤–∫–æ–π
        discord_id: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Discord
    """
    # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é view —Å –Ω–µ–∞–∫—Ç–∏–≤–Ω—ã–º–∏ –∫–Ω–æ–ø–∫–∞–º–∏
    view = discord.ui.View(timeout=None)
    button = discord.ui.Button(
        style=discord.ButtonStyle.green,
        label="–û–¥–æ–±—Ä–µ–Ω–æ",
        emoji="‚úÖ",
        disabled=True,
        custom_id=f"approved_{discord_id}"
    )
    view.add_item(button)
    
    # –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, —É–±–∏—Ä–∞—è —É–ø–æ–º–∏–Ω–∞–Ω–∏–µ —Ä–æ–ª–∏ –º–æ–¥–µ—Ä–∞—Ç–æ—Ä–∞
    await message.edit(
        content=f"## –ó–∞—è–≤–∫–∞ –∏–≥—Ä–æ–∫–∞ <@{discord_id}>",
        view=view
    )


async def update_candidate_message(message: discord.Message, discord_id: str) -> None:
    """
    –û–±–Ω–æ–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ –∑–∞—è–≤–∫–∏ –ø—Ä–∏ –ø–µ—Ä–µ–≤–æ–¥–µ –≤ –∫–∞–Ω–¥–∏–¥–∞—Ç—ã.
    
    Args:
        message: –°–æ–æ–±—â–µ–Ω–∏–µ Discord —Å –∑–∞—è–≤–∫–æ–π
        discord_id: ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è Discord
    """
    # –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—É—é view —Å –∫–Ω–æ–ø–∫–∞–º–∏ –¥–ª—è –∫–∞–Ω–¥–∏–¥–∞—Ç–∞
    view = discord.ui.View(timeout=None)
    
    # –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ–º –∫–ª–∞—Å—Å—ã –∫–Ω–æ–ø–æ–∫ –ª–æ–∫–∞–ª—å–Ω–æ —á—Ç–æ–±—ã –∏–∑–±–µ–∂–∞—Ç—å —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∏–º–ø–æ—Ä—Ç–æ–≤
    from ..ui.buttons import ApproveButton, RejectButton
    
    # –ö–Ω–æ–ø–∫–∞ "–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏" (–Ω–µ–∞–∫—Ç–∏–≤–Ω–∞—è)
    candidate_button = discord.ui.Button(
        style=discord.ButtonStyle.primary,
        label="–ù–∞ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ–Ω–∏–∏",
        emoji="üîç",
        disabled=True,
        custom_id=f"candidate_disabled_{discord_id}"
    )
    
    # –î–æ–±–∞–≤–ª—è–µ–º –∫–Ω–æ–ø–∫–∏ –≤ view –≤ –Ω—É–∂–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
    view.add_item(candidate_button)
    view.add_item(ApproveButton(discord_id, is_candidate=True))
    view.add_item(RejectButton(discord_id, is_candidate=True))
    
    # –û–±–Ω–æ–≤–ª—è–µ–º –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
    await message.edit(
        content=f"## –ó–∞—è–≤–∫–∞ –∫–∞–Ω–¥–∏–¥–∞—Ç–∞ <@{discord_id}>",
        view=view
    )


async def send_welcome_message(member: discord.Member) -> None:
    """
    –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –Ω–æ–≤–æ–º—É —É—á–∞—Å—Ç–Ω–∏–∫—É.
    
    Args:
        member: –ù–æ–≤—ã–π —É—á–∞—Å—Ç–Ω–∏–∫ —Å–µ—Ä–≤–µ—Ä–∞
    """
    import os
    from dotenv import load_dotenv
    load_dotenv()

    try:
        welcome_message = (
            "**–¢–≤–æ—è –∑–∞—è–≤–∫–∞ –Ω–∞–º –ø–æ–Ω—Ä–∞–≤–∏–ª–∞—Å—å –∏ —Ç—ã –¥–æ–ø—É—â–µ–Ω –Ω–∞ —Å–µ—Ä–≤–µ—Ä!**\n\n"

            #"> <:pointPurple:1293951536451551376> –ó–¥–µ—Å—å —Ç—ã –º–æ–∂–µ—à—å –Ω–∞–ø–∏—Å–∞—Ç—å __–ø–æ–¥—Ä–æ–±–Ω—É—é__ –±–∏–æ–≥—Ä–∞—Ñ–∏—é —Å–≤–æ–µ–≥–æ –ø–µ—Ä—Å–æ–Ω–∞–∂–∞:\n"
            #"> <:empty:1293950977275199619><:subEntriesPurple:1293951605372354703> –ü–∏—à–∏ –æ —á—ë–º —É–≥–æ–¥–Ω–æ, –∫—Ä–æ–º–µ —Å–æ–≤—Å–µ–º –±–µ–∑—É–º–Ω–æ–≥–æ, __–º—É–ª—å—Ç–∏–≤—ë—Ä—Å–∞__.\n"
            #"> <:empty:1293950977275199619><:subEntriesPurple:1293951605372354703> –ü–æ–º–Ω–∏, —á—Ç–æ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –ù–ï–¢ —Ü–∏–≤–∏–ª–∏–∑–∞—Ü–∏–∏, —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ –µ—Å–ª–∏ —Ç—ã –∫–∏–±–æ—Ä–≥, —Ç–æ, –≤–æ–∑–º–æ–∂–Ω–æ, –∏–∑ –±—É–¥—É—â–µ–≥–æ –∏–ª–∏ –ø—Ä–æ—à–ª–æ–≥–æ. –ò–ª–∏ —Ç–µ–±—è —Å–æ–æ—Ä—É–¥–∏–ª –±–µ–∑—É–º–Ω—ã–π —É—á—ë–Ω—ã–π, –∫–æ—Ç–æ—Ä—ã–π –¥–∞–≤–Ω–æ –ø–æ–≥—Ä–µ–±—ë–Ω –ø–æ–¥ –∑–µ–º–ª—ë–π.\n"
            #"> <:empty:1293950977275199619><:subEntriesPurple:1293951605372354703> –ü—Ä–æ–¥—É–º–∞–π —Å–≤–æ–∏ –º–µ—Ö–∞–Ω–∏–∫–∏, –ø–æ—á–∏—Ç–∞–π –ø—Ä–∏–º–µ—Ä –∏ –±–∏–æ–≥—Ä–∞—Ñ–∏–∏ –¥—Ä—É–≥–∏—Ö –∏–≥—Ä–æ–∫–æ–≤. –° –Ω–∏–º–∏ —Ç—ã –±—É–¥–µ—à—å –¥–æ –∫–æ–Ω—Ü–∞ —Å–µ–∑–æ–Ω–∞ –∏ —Ç–∞–∫ –ø—Ä–æ—Å—Ç–æ –ø–æ–º–µ–Ω—è—Ç—å –Ω–µ —Å–º–æ–∂–µ—à—å. –£ —Ç–µ–±—è –Ω–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–∏–ª–ª–∏–æ–Ω –ø–ª—é—Å–æ–≤ –∏ 2-3 –º–∏–Ω—É—Å–∞, –∏ –Ω–∞–æ–±–æ—Ä–æ—Ç, –Ω–µ —É—Å–ª–æ–∂–Ω—è–π —Å–ª–∏—à–∫–æ–º —Å–∏–ª—å–Ω–æ —Å–µ–±–µ –∏–≥—Ä—É.\n"
            #"> <:pointPurple:1293951536451551376> –ü–æ—Å–ª–µ –Ω–∞–ø–∏—Å–∞–Ω–∏—è –±–∏–æ–≥—Ä–∞—Ñ–∏–∏ –¥–æ–∂–¥–∏—Å—å —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–¥–∞–Ω–∏—è –æ—Ç –ö–æ—Ñ–µ–π–∫–∞, –ø—Ä–æ–≤–µ—Ä—å –≤—Å—ë –≤ –æ–¥–∏–Ω–æ—á–Ω–æ–º –º–∏—Ä–µ –∏ —Ç–æ–ª—å–∫–æ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–∞–π, –ø–µ—Ä–µ–¥–µ–ª—ã–≤–∞—Ç—å –ø–æ—Ç–æ–º –±—É–¥–µ—Ç –æ—á–µ–Ω—å —Å–ª–æ–∂–Ω–æ.\n"
            #'–ü–∏—Å–∞—Ç—å —Å—é–¥–∞ ‚û• <#1280238897418338304> (—Å —Ç–µ–≥–æ–º "–ó–∞—è–≤–∫–∞ –Ω–∞ –ù–æ–≤—É—é –ë–ò–û")\n'
            #"<:pointPurple:1293951536451551376> –¢—ã —Ç–∞–∫–∂–µ –º–æ–∂–µ—à—å –∏ –Ω–µ –ø–∏—Å–∞—Ç—å –±–∏–æ–≥—Ä–∞—Ñ–∏—é, –µ—Å–ª–∏ —Ö–æ—á–µ—à—å –ø—Ä–æ—Å—Ç–æ –ø–æ–∏–≥—Ä–∞—Ç—å, –Ω–æ —Ç–æ–≥–¥–∞ –Ω–µ –∂–∞–ª—É–π—Å—è, —á—Ç–æ –Ω–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã—Ö –º–µ—Ö–∞–Ω–∏–∫.\n\n\n"
            
            "<:pointPurple:1293951536451551376> –°–µ–π—á–∞—Å –∏–¥—ë—Ç **–ú–ï–ñ–°–ï–ó–û–ù–¨–ï**, –∞ —ç—Ç–æ –∑–Ω–∞—á–∏—Ç, —á—Ç–æ –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ –Ω–∏—á–µ–≥–æ –¥–µ–ª–∞—Ç—å –Ω–µ –Ω–∞–¥–æ!\n"
            f"> <:empty:1293950977275199619><:subEntriesPurple:1293951605372354703> –í—ã —Ç–æ–ª—å–∫–æ —á—Ç–æ –ø–æ–ª—É—á–∏–ª–∏ —Ä–æ–ª—å –ú–∞–π–Ω–±–∏–ª–¥–æ–≤—Ü–∞. –í–µ—Ä–Ω–∏—Ç–µ—Å—å –Ω–∞ [—Å–∞–π—Ç]({os.getenv('WEB_URL')}) –∏ –æ–±–Ω–æ–≤–∏—Ç–µ —Å—Ç—Ä–∞–Ω–∏—Ü—É.\n"
            "> <:empty:1293950977275199619><:subEntriesPurple:1293951605372354703> –í –ª–∏—á–Ω–æ–º –∫–∞–±–∏–Ω–µ—Ç–µ (–Ω–∞–∂–º–∏—Ç–µ –Ω–∞ —Å–≤–æ–π –∞–≤–∞—Ç–∞—Ä –≤ –ø—Ä–∞–≤–æ–º –≤–µ—Ä—Ö–Ω–µ–º —É–≥–ª—É) –¥–æ–ª–∂–Ω–∞ –ø–æ—è–≤–∏—Ç—Å—è –∫–Ω–æ–ø–∫–∞ *__–°–∫–∞—á–∞—Ç—å —Å–±–æ—Ä–∫—É__*.\n"
            "> <:empty:1293950977275199619><:subEntriesPurple:1293951605372354703> –î–æ–∂–¥–∏—Ç–µ—Å—å —Å–∫–∞—á–∏–≤–∞–Ω–∏—è. –í –ª–∞—É–Ω—á–µ—Ä–µ —Å–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —ç–∫–∑–µ–º–ø–ª—è—Ä –∏–≥—Ä—ã –∏ –ø–µ—Ä–µ–∫–∏–Ω—å—Ç–µ —Ñ–∞–π–ª—ã –∏–∑ –∞—Ä—Ö–∏–≤–∞ –≤ –∫–æ—Ä–Ω–µ–≤—É—é –ø–∞–ø–∫—É –Ω–æ–≤–æ–≥–æ —ç–∫–∑–µ–º–ø–ª—è—Ä–∞. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∑–∞–π—Ç–∏ –≤ –∏–≥—Ä—É.\n"
            "<:pointPurple:1293951536451551376> –ï—Å–ª–∏ –≤—ã —Å—Ç–æ–ª–∫–Ω—É–ª–∏—Å—å —Å –ø—Ä–æ–±–ª–µ–º–∞–º–∏, —Å–æ–æ–±—â–∏—Ç–µ –æ–± —ç—Ç–æ–º –≤ –Ω–∞—à–µ–º —á–∞—Ç–∏–∫–µ!\n\n\n"
            "**–ù–∞—à —á–∞—Ç–∏–∫:** <#1150073742840565810>\n"
            "**–ù–∞—à —Ñ–æ—Ä—É–º–Ω–∏–∫:** <#1280238897418338304>\n"
            "**–ù–∞—à–∏ –Ω–æ–≤–æ—Å—Ç–∏:** <#1153038125589868564>\n"
            "**–ù–∞—à–∏ –±–∏–æ–≥—Ä–∞—Ñ–∏–∏ (–Ω–µ–∞–∫—Ç—É–∞–ª—å–Ω–æ):** <#1279139724820217894>\n"
            "-# –ó–∞–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ, –Ω–æ –∏—Å–∫—Ä–µ–Ω–Ω–µ–µ. –ü–æ –≤—Å–µ–º –≤–æ–ø—Ä–æ—Å–∞–º —Å–º–µ–ª–æ –ø–∏—à–∏ –≤ —á–∞—Ç –æ–±—â–µ–Ω–∏—è!"
        )
        await member.send(welcome_message)
        logger.info(f"–ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {member.id}")
        
    except discord.Forbidden:
        logger.warning(f"–ù–µ —É–¥–∞–ª–æ—Å—å –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é {member.id} - –õ–° –∑–∞–∫—Ä—ã—Ç—ã")
    except Exception as e:
        logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—Ç–ø—Ä–∞–≤–∫–µ –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è: {e}", exc_info=True)
